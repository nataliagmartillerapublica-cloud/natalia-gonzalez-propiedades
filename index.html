<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Casa patagónica con vista al lago – Aldea del Este</title>
  <meta name="description" content="Casa patagónica 4 dormitorios con vista al Nahuel Huapi, Aldea del Este, Bariloche. Lote 874 m², 190 m² cubiertos. Coordinación por WhatsApp." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand:#572d30; --brand-ink:#ffffff; --accent:#363332;
      --ink:#363332; --muted:#666; --bg:#f4f2f2; --line:#e5e5e5; --tint:#efeded;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Helvetica Neue',Arial,'Noto Sans',sans-serif;color:var(--ink);background:var(--bg)}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    .header{position:sticky;top:0;background:rgba(255,255,255,.92);backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid var(--line);z-index:10}
    .brandbar{height:4px;background:linear-gradient(90deg,var(--brand),var(--accent))}
    .row{display:grid;grid-template-columns:1fr;gap:24px}
    @media(min-width:960px){.row{grid-template-columns:1.15fr .85fr}}
    .pill{display:inline-block;padding:12px 18px;border:1px solid var(--ink);border-radius:999px;text-decoration:none;color:var(--ink)}
    .pill.primary{background:var(--brand);color:var(--brand-ink);border-color:var(--brand)}
    .pill.ghost{background:#fff}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;background:var(--tint);padding:8px;border-radius:16px}
    .card{border:1px solid var(--line);border-radius:16px;padding:16px;background:white}
    .muted{color:var(--muted);font-size:14px}
    .h1{font-size:28px;margin:0 0 8px}
    .h2{font-size:20px;margin:24px 0 8px}
    .img{width:100%;height:160px;object-fit:cover;border-radius:12px;display:block}
    .btns{display:flex;flex-wrap:wrap;gap:12px;margin-top:16px}
    @media(max-width:600px){
      .btns .pill{width:100%;text-align:center}
      .grid{grid-template-columns:repeat(2,1fr)}
      .img{height:200px}
      .h1{font-size:24px}
      .container{padding:16px}
    }
    /* Modal ficha */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
    .modal{max-width:520px;width:100%;background:#fff;border:1px solid var(--line);border-radius:14px;padding:16px}
    .modal h3{margin:0 0 6px}
    .hidden{display:none}
    /* Admin */
    .admin-card{border:1px dashed #d4a373;background:#fff7ed;color:#7c3e00;border-radius:12px;padding:12px}
    .input{height:40px;border:1px solid #ddd;border-radius:10px;padding:8px;background:#fff}
    .micro{font-size:12px;color:#7c3e00}
  </style>
</head>
<body>
  <header class="header" aria-label="Encabezado">
    <div class="brandbar"></div>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;padding-top:12px;padding-bottom:12px">
      <strong>Natalia González · Martillera (Mat. 377-RP-21 Fº456 TºII)</strong>
    </div>
  </header>

  <main class="container">
    <!-- HERO -->
    <section class="row" style="margin-top:24px">
      <div>
        <h1 class="h1">Casa estilo patagónico – 4 dormitorios – vista al lago (Aldea del Este)</h1>
        <p><strong>Aldea del Este – La Morena 4276, Bariloche.</strong> Arquitectura patagónica con vistas al lago Nahuel Huapi desde ambientes principales. Lote <strong>874 m²</strong>, superficie cubierta <strong>190 m²</strong>. Cochera doble. Accesos ágiles y cercanía a servicios.</p>

        <div class="card" style="background:var(--tint);border-color:var(--line)">
          <strong>¿Querés coordinar una visita?</strong>
          <p class="muted" style="margin:6px 0 0">El botón de contacto está al final de esta página. Desde allí te respondo por WhatsApp con la ficha y opciones de visita.</p>
        </div>
      </div>

      <div aria-label="Galería de imágenes">
        <div class="grid" role="img" aria-label="Galería de fotos de la casa">
          <img src="/img/portada.jpg"    alt="Fachada principal de la casa en Aldea del Este" class="img" loading="eager" />
          <img src="/img/living.jpg"     alt="Living con vista al lago" class="img" loading="lazy" />
          <img src="/img/dormitorio.jpg" alt="Dormitorio principal" class="img" loading="lazy" />
          <img src="/img/cocina.jpg"     alt="Cocina amplia" class="img" loading="lazy" />
          <img src="/img/galeria.jpg"    alt="Galería, deck y jardín" class="img" loading="lazy" />
          <img src="/img/vista.jpg"      alt="Vista al lago Nahuel Huapi" class="img" loading="lazy" />
        </div>
      </div>
    </section>

    <!-- HIGHLIGHTS -->
    <section>
      <h2 class="h2">Highlights</h2>
      <div class="row">
        <div class="card" aria-label="Características destacadas">
          <span class="pill">Apto crédito hipotecario</span>
          <span class="pill">4 dormitorios + escritorio</span>
          <span class="pill">2 baños</span>
          <span class="pill">Vista al lago</span>
          <span class="pill">Lote 874 m²</span>
          <span class="pill">Cubiertos 190 m²</span>
          <span class="pill">Calefacción por radiadores</span>
          <span class="pill">Cochera para 2 autos</span>
          <span class="pill">Orientación Norte</span>
          <span class="pill">Antigüedad: 23 años</span>
        </div>
      </div>
    </section>

    <!-- DESCRIPCIÓN -->
    <section>
      <h2 class="h2">Descripción breve</h2>
      <p>Distribución: living-comedor con hogar y ventanales a vistas, cocina amplia, dormitorio principal (en planta a confirmar), tres dormitorios secundarios, escritorio/vestidor, dos baños completos y lavadero. Exterior: jardín, deck y cochera doble cubierta.</p>
      <p>Terminaciones en piedra y madera; carpinterías de calidad y buena iluminación natural. Servicios: luz, gas y agua. Sistema de calefacción por radiadores en todos los ambientes.</p>
    </section>

    <!-- INFO COMERCIAL + BOTONES -->
    <section>
      <h2 class="h2">Información comercial</h2>
      <div class="row">
        <div class="card">
          <p><strong>VALOR:</strong> USD 296.000</p>
          <p><strong>Condiciones:</strong> apto crédito hipotecario (sujeto a calificación y tasación bancaria).</p>
          <p><strong>Visitas:</strong> con coordinación previa.</p>

          <div class="btns" style="margin-top:20px">
            <!-- VER (lleva a tu publicación pública) -->
            <a id="btn-ver" class="pill ghost" href="#" target="_blank" rel="noopener">VER</a>

            <!-- FICHA (abre modal Ver/Descargar) -->
            <button id="btn-ficha" class="pill primary" type="button">FICHA</button>

            <!-- WhatsApp -->
            <a id="whatsapp-buyvisit" class="pill" href="#">Escribime por WhatsApp</a>
          </div>

          <p class="muted" style="margin-top:8px">Coordinamos por WhatsApp para agilizar.</p>
        </div>
      </div>
    </section>

    <!-- ADMIN (oculto, se muestra con ?admin=1) -->
    <section id="ngd-admin-panel" class="hidden" style="margin-top:28px">
      <div class="admin-card">
        <strong>Admin (privado): fuentes de datos</strong>
        <p class="micro" style="margin:6px 0 10px">Este panel no es visible al público. Se abre con <code>?admin=1</code> y guarda en tu navegador.</p>

        <label class="micro" for="ngd-csv">URL CSV de Google Sheets (propiedades)</label>
        <input id="ngd-csv" class="input" placeholder="https://docs.google.com/.../pub?output=csv" />

        <div style="height:8px"></div>

        <label class="micro" for="ngd-pdf">URL PDF de la FICHA (esta propiedad)</label>
        <input id="ngd-pdf" class="input" placeholder="https://.../ficha.pdf" />

        <div style="display:flex;gap:8px;margin-top:10px">
          <button id="ngd-test"  class="pill ghost" type="button">Probar CSV</button>
          <button id="ngd-save"  class="pill primary" type="button">Guardar</button>
          <button id="ngd-clear" class="pill ghost" type="button">Borrar</button>
        </div>
        <div id="ngd-status" class="micro" style="margin-top:8px"></div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container muted" style="padding:16px 24px">© <span id="year"></span> Natalia González · Martillera Pública. Bariloche.</div>
  </footer>

  <!-- MODAL FICHA -->
  <div id="ficha-backdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal">
      <h3>Ficha de la propiedad</h3>
      <p class="muted" style="margin:6px 0 12px">Podés abrirla para ver online o descargarla.</p>
      <div class="btns">
        <a id="ficha-ver" class="pill primary" target="_blank" rel="noopener">Ver ficha</a>
        <a id="ficha-descargar" class="pill ghost" download>Descargar PDF</a>
        <button id="ficha-cerrar" class="pill ghost" type="button">Cerrar</button>
      </div>
    </div>
  </div>

  <script>
    /* ---------- CONFIG RÁPIDA (si no usás el admin) ---------- */
    const PUBLIC_LINK = 'https://www.zonaprop.com.ar/';      // <-- link público (Zonaprop / tu página)
    const PDF_FICHA_FALLBACK = 'https://tu-dominio.com/ficha.pdf'; // <-- PDF si no cargás por admin

    /* ---------- UTILIDADES CSV (para futuro listado) ---------- */
    const LS_KEY_CSV  = 'ngespacios:csvUrl';
    const LS_KEY_PDF  = 'ngespacios:fichaPdf';

    function normalizeSheetUrlToCsv(u){
      try {
        const x = new URL(u);
        if (x.hostname.includes('docs.google.com')) {
          if (x.pathname.endsWith('/pub')) { x.searchParams.set('output','csv'); return x.toString(); }
          if (x.pathname.includes('/export')) { x.searchParams.set('format','csv'); return x.toString(); }
        }
      } catch {}
      return u;
    }
    async function fetchCsv(u){ const r = await fetch(u,{cache:'no-store'}); if(!r.ok) throw new Error('HTTP '+r.status); return r.text(); }
    function parseCSV(t){
      const rows=[];let i=0,f='',row=[],q=false;
      function PF(){row.push(f.replace(/\\"\\"/g,'\\"'));f=''}
      function PR(){rows.push(row);row=[]}
      while(i<t.length){const c=t[i];
        if(q){ if(c=='"'){ if(t[i+1]=='"'){f+='"';i+=2;continue}else{q=false;i++;continue} } else { f+=c;i++;continue } }
        else{ if(c=='"'){ q=true;i++;continue } if(c==','){ PF();i++;continue } if(c=='\n'){ PF();PR();i++;continue } if(c=='\r'){ i++;continue } f+=c;i++; }
      }
      PF(); if(row.length>1||(row.length==1&&row[0]!=='')) PR();
      if(!rows.length) return [];
      const h=rows[0].map(x=>(x||'').trim()),data=[];
      for(let r=1;r<rows.length;r++){const v=rows[r],o={};h.forEach((k,ix)=>o[k]=(v[ix]||'').trim());data.push(o)}
      return data;
    }

    /* ---------- WHATSAPP ---------- */
    (function setupWhatsApp(){
      const msg = encodeURIComponent('Hola, me interesa la casa de Aldea del Este. Mi nombre es: ______. Quiero coordinar una visita.');
      const href = 'https://wa.me/5492944635083?text=' + msg + '&utm_source=landing&utm_medium=cta&utm_campaign=aldea_del_este';
      const btn = document.getElementById('whatsapp-buyvisit');
      if (btn) btn.href = href;
    })();

    /* ---------- BOTÓN VER + FICHA ---------- */
    (function setupVerYFicha(){
      // VER
      const aVer = document.getElementById('btn-ver');
      if (aVer) aVer.href = PUBLIC_LINK;

      // FICHA (modal)
      const getPdfUrl = () => (localStorage.getItem(LS_KEY_PDF) || '').trim() || PDF_FICHA_FALLBACK;

      const openModal = () => {
        const url = getPdfUrl();
        const bd = document.getElementById('ficha-backdrop');
        const aOpen = document.getElementById('ficha-ver');
        const aDl   = document.getElementById('ficha-descargar');

        if (aOpen) aOpen.href = url;
        if (aDl)   { aDl.href = url; aDl.setAttribute('download', 'ficha.pdf'); }
        if (bd) { bd.style.display = 'flex'; bd.setAttribute('aria-hidden','false'); }
      };
      const closeModal = () => {
        const bd = document.getElementById('ficha-backdrop');
        if (bd) { bd.style.display = 'none'; bd.setAttribute('aria-hidden','true'); }
      };

      document.getElementById('btn-ficha')?.addEventListener('click', openModal);
      document.getElementById('ficha-cerrar')?.addEventListener('click', closeModal);
      document.getElementById('ficha-backdrop')?.addEventListener('click', (e)=>{ if(e.target.id==='ficha-backdrop') closeModal(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });
    })();

    /* ---------- ADMIN (abre con ?admin=1) ---------- */
    (function adminPanel(){
      const $ = id => document.getElementById(id);
      const p = $('ngd-admin-panel'); if (!p) return;

      // Mostrar auto si viene ?admin=1
      try { const u = new URL(location.href); if (u.searchParams.get('admin')==='1') p.classList.remove('hidden'); } catch {}

      const iCsv = $('ngd-csv'),  iPdf = $('ngd-pdf'), s = $('ngd-status');
      try { iCsv.value = localStorage.getItem(LS_KEY_CSV) || ''; } catch {}
      try { iPdf.value = localStorage.getItem(LS_KEY_PDF) || ''; } catch {}

      $('ngd-test')?.addEventListener('click', async ()=>{
        s.textContent = 'Probando CSV...';
        try {
          const raw = iCsv.value.trim(); if(!raw){ s.textContent='Pegá una URL CSV.'; return; }
          const url = normalizeSheetUrlToCsv(raw);
          const csv = await fetchCsv(url);
          const rows = parseCSV(csv);
          const valid = rows.filter(r => (r.id||'').trim() && (r.title||'').trim());
          s.textContent = `OK: ${rows.length} filas, ${valid.length} válidas (id+title).`;
        } catch(e){ console.error(e); s.textContent='Error leyendo el CSV.'; }
      });

      $('ngd-save')?.addEventListener('click', ()=>{
        try {
          if (iCsv.value.trim()) localStorage.setItem(LS_KEY_CSV, normalizeSheetUrlToCsv(iCsv.value.trim()));
          if (iPdf.value.trim()) localStorage.setItem(LS_KEY_PDF, iPdf.value.trim());
          s.textContent='Guardado. Recargá la página si cambiaste la fuente.';
        } catch { s.textContent='No se pudo guardar en este navegador.'; }
      });

      $('ngd-clear')?.addEventListener('click', ()=>{
        try { localStorage.removeItem(LS_KEY_CSV); localStorage.removeItem(LS_KEY_PDF); } catch {}
        if (iCsv) iCsv.value=''; if (iPdf) iPdf.value='';
        s.textContent='Borrado. Usará los valores por defecto del sitio.';
      });
    })();

    /* ---------- AÑO FOOTER ---------- */
    (function(){ const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear(); })();
  </script>
</body>
</html>
